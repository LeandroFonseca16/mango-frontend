{
  "info": {
    "name": "MangoBeat AI - Backend API",
    "description": "Collection completa para testar o backend do MangoBeat AI",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:3001/api/v1",
      "type": "string"
    },
    {
      "key": "token",
      "value": "",
      "type": "string"
    },
    {
      "key": "trackId",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "1. Auth",
      "item": [
        {
          "name": "1.1 Registrar Usuário",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    console.log('✅ Usuário criado:', response.email);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"postman@mangobeat.com\",\n  \"password\": \"Postman123!\",\n  \"name\": \"Postman User\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/register",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "register"]
            },
            "description": "Cria um novo usuário no sistema"
          }
        },
        {
          "name": "1.2 Login (Salva Token)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    pm.collectionVariables.set('token', response.accessToken);",
                  "    console.log('✅ Token salvo automaticamente!');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"postman@mangobeat.com\",\n  \"password\": \"Postman123!\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "login"]
            },
            "description": "Faz login e salva o token JWT automaticamente"
          }
        }
      ],
      "description": "Endpoints de autenticação"
    },
    {
      "name": "2. Tracks",
      "item": [
        {
          "name": "2.1 Gerar Track com IA",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 202) {",
                  "    const response = pm.response.json();",
                  "    pm.collectionVariables.set('trackId', response.trackId);",
                  "    console.log('✅ Track ID salvo:', response.trackId);",
                  "    console.log('⏳ Aguarde', response.estimatedTime);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Phonk do Postman\",\n  \"description\": \"Beat criado via Postman\",\n  \"genre\": \"phonk\",\n  \"tags\": [\"phonk\", \"postman\", \"test\"],\n  \"audioPrompt\": \"Heavy phonk beat with 808 bass, cowbell, and Memphis vocals. BPM 150\",\n  \"imagePrompt\": \"Dark purple aesthetic cover art with cyberpunk city at night\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/tracks/generate",
              "host": ["{{baseUrl}}"],
              "path": ["tracks", "generate"]
            },
            "description": "Gera uma nova track usando IA. Aguarde 10-15 segundos para processar."
          }
        },
        {
          "name": "2.2 Buscar Track por ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/tracks/{{trackId}}",
              "host": ["{{baseUrl}}"],
              "path": ["tracks", "{{trackId}}"]
            },
            "description": "Busca uma track específica. Use após gerar a track para ver o resultado."
          }
        },
        {
          "name": "2.3 Listar Minhas Tracks",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/tracks",
              "host": ["{{baseUrl}}"],
              "path": ["tracks"]
            },
            "description": "Lista todas as tracks do usuário logado"
          }
        },
        {
          "name": "2.4 Buscar por Gênero",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/tracks/genre/phonk",
              "host": ["{{baseUrl}}"],
              "path": ["tracks", "genre", "phonk"]
            },
            "description": "Busca tracks por gênero musical"
          }
        }
      ],
      "description": "Endpoints de gerenciamento de tracks"
    },
    {
      "name": "3. Jobs",
      "item": [
        {
          "name": "3.1 Buscar Job por ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/jobs/1",
              "host": ["{{baseUrl}}"],
              "path": ["jobs", "1"]
            },
            "description": "Busca informações de um job específico"
          }
        },
        {
          "name": "3.2 Listar Jobs do Usuário",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/jobs/user/me",
              "host": ["{{baseUrl}}"],
              "path": ["jobs", "user", "me"]
            },
            "description": "Lista todos os jobs do usuário logado"
          }
        }
      ],
      "description": "Endpoints de jobs assíncronos"
    },
    {
      "name": "4. Trends",
      "item": [
        {
          "name": "4.1 Trends Populares",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/trends/popular",
              "host": ["{{baseUrl}}"],
              "path": ["trends", "popular"]
            },
            "description": "Busca tendências populares do TikTok (fake data)"
          }
        },
        {
          "name": "4.2 Trends em Alta",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/trends/trending",
              "host": ["{{baseUrl}}"],
              "path": ["trends", "trending"]
            },
            "description": "Busca tendências em alta no momento (fake data)"
          }
        }
      ],
      "description": "Endpoints de tendências do TikTok"
    }
  ]
}
